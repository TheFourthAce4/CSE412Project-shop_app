<!-- orders.html -->

{% extends "layout.html" %}
{% block content %}
<h2 class="mb-3">Orders</h2>

<table class="table table-striped table-bordered mb-4">
  <thead>
    <tr>
      <th>ID</th><th>Date</th><th>Status</th><th>Payment</th>
      <th>Total</th><th>Customer</th><th>Actions</th>
    </tr>
  </thead>
  <tbody>
  {% for o in orders %}
    <tr>
      <td>{{ o.order_id }}</td>
      <td>{{ o.order_date }}</td>
      <td>{{ o.status }}</td>
      <td>{{ o.payment_method }}</td>
      <td>{{ o.total_amount }}</td>
      <td>{{ o.customer_name }}</td>
      <td>
        <a class="btn btn-sm btn-secondary" href="{{ url_for('order_detail', order_id=o.order_id) }}">
          View / Edit
        </a>
        <form method="post"
              action="{{ url_for('delete_order', order_id=o.order_id) }}"
              style="display:inline"
              onsubmit="return confirm('Delete this order?');">
          <button class="btn btn-sm btn-danger">Delete</button>
        </form>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<h3>Create New Order</h3>
<form method="post" action="{{ url_for('add_order') }}" class="row g-2">
  <div class="col-md-3">
    <label class="form-label">Order Date</label>
    <input type="date" class="form-control" name="order_date" required>
  </div>
  <div class="col-md-3">
    <label class="form-label">Customer</label>
    <select class="form-select" name="customer_id" required>
      <option value="">Select...</option>
      {% for c in customers %}
        <option value="{{ c.customer_id }}">{{ c.name }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <label class="form-label">Employee (Optional)</label>
    <select class="form-select" name="employee_id">
      <option value="">None</option>
      {% for e in employees %}
        <option value="{{ e.employee_id }}">{{ e.name }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <label class="form-label">Payment Method</label>
    <select class="form-select" name="payment_method">
      <option value="CASH">CASH</option>
      <option value="CARD">CARD</option>
      <option value="TRANSFER">TRANSFER</option>
      <option value="OTHER">OTHER</option>
    </select>
  </div>
  <div class="col-md-3">
    <label class="form-label">Initial Status</label>
    <select class="form-select" name="status">
      <option value="NEW">NEW</option>
      <option value="PAID">PAID</option>
      <option value="SHIPPED">SHIPPED</option>
      <option value="CANCELLED">CANCELLED</option>
    </select>
  </div>
  <div class="col-md-3 align-self-end">
    <button class="btn btn-primary w-100 mt-2">Create Order</button>
  </div>
</form>
{% endblock %}